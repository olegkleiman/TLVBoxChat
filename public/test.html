<!DOCTYPE html> 
<html> 
  
<head>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta charset="UTF-8" />
    <style>
        df-messenger {
          z-index: 999;
          position: fixed;
          /* --df-messenger-button-titlebar-color: #df9b56; */
          --df-messenger-button-titlebar-color: #0a2f79;
          --df-messenger-font-color: #000;
          --df-messenger-font-family: Google Sans;
          --df-messenger-font-size: 14px;
          --df-messenger-chat-background: #f3f6fc;
          --df-messenger-message-user-background: #d3e3fd;
          --df-messenger-message-bot-background: #ecf3fe; 
          --df-messenger-input-background: white;
          /* #fff; */
          bottom: 16px;
          right: 16px;
          
        }
    </style>
    <link rel="stylesheet" href="https://www.gstatic.com/dialogflow-console/fast/df-messenger/prod/v1/themes/df-messenger-default.css">    
    <!-- <script src="https://www.gstatic.com/dialogflow-console/fast/df-messenger/prod/v1/df-messenger.js"></script> -->
    <script src="https://www.gstatic.com/dialogflow-console/fast/messenger/bootstrap.js?v=1"></script>
</head> 
  
<body> 
    <df-messenger
        project-id="muni-tlv"
        agent-id="46727f85-4983-4edb-b8b1-55df166837da"
        language-code="he-il"
        storage-option="none"
        chat-icon="./assets/img/HAL9001Logo.png"
        chat-title-icon="./assets/img/HAL9001Logo.png"
        max-query-length="-1">
            <df-messenger-chat-bubble
                expanded="true"
                chat-title="TLV Box"
                chat-subtitle="Personal Assistant"
                allow-fullscreen="always">
            </df-messenger-chat-bubble>
    </df-messenger>
    <script>
        const dfMessenger = document.querySelector('df-messenger');
        //dfMessenger.renderCustomText('Welcome! This text comes from the client-script.');
        
        // const _shadowRoot = document.querySelector('df-messenger-user-input');
        // var shadowRoot = _shadowRoot.shadowRoot;
        // const sendButton = hadowRoot.getElementById('send-icon-button');
        // {
        //     _dfMessenger.addEventListener( 'df-messenger-loaded', function( event ) {
        //         console.log('Messenger is now ready.');
        //     });
        // }
        window.addEventListener('df-messenger-loaded', function() {

            console.log('Messenger is now ready.');

            //const sendButton = document.shadowRoot.getElementById('send-icon-button');

            const payload = [
                {
                    "type": "info",
                    "title": "Info item title",
                    "subtitle": "Info item subtitle",
                    "image": {
                    "rawUrl": "https://example.com/images/logo.png"
                    },
                    "anchor": {
                    "href": "https://example.com",
                    "target": "_blank"
                    }
                }
            ];
            dfMessenger.renderCustomCard(payload);
            dfMessenger.setQueryParameters('{"timeZone": "America/New_York"}')
        });

        window.addEventListener('df-session-id-set', function(event) {
            console.log('Session set');
        });

        dfMessenger.addEventListener('df-chat-open-changed', function(event) {
            console.log(`Chat is ${event.detail.isOpen ? 'open' : 'closed'}`);
            const sendButton = document.getElementById('send-icon-button');
        });
        window.addEventListener('df-messenger-error', function (event) {
            console.log(event.detail.error)
        });
        window.addEventListener('df-request-sent', (event) => {
            console.log('Request', event.detail.data.requestBody);
        });
        window.addEventListener('df-response-received', (event) => {
            console.log(event.detail)
        })
        window.addEventListener('df-chip-clicked', (event) => {
            console.log(event)
        })
        window.addEventListener('df-user-input-entered', (event) => {
            console.log(event)
        })

        setTimeout(() => {
            var buttons = document.getElementsByTagName('button');
        }, 1000);
        
    </script>
</body> 
  
</html>  